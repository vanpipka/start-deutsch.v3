{% extends "core/base.html" %}

{% block title %}–≠–∫–∑–∞–º–µ–Ω—ã{% endblock %}

{% block content %}

<!-- Header -->
<section class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white">
    <div class="max-w-7xl mx-auto px-4 py-16">
        <h1 class="text-4xl font-bold mb-2">
            {% if header %}{{ header }}{% else %}–≠–∫–∑–∞–º–µ–Ω—ã{% endif %}
        </h1>
        <p class="text-blue-100">
            –ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π –ø—Ä–æ–≥—Ä–µ—Å—Å
        </p>
    </div>
</section>

<!-- Exams -->
<section class="max-w-7xl mx-auto px-4 py-16">

    {% include "core/components/breadcrumbs.html" %}

    {% if categories %}
        <div class="flex flex-wrap gap-3 mb-10">
            <a href="{% url 'tests:exam_list' %}"
               class="px-4 py-2 rounded-full text-sm border
               {% if not current_category %}bg-blue-600 text-white border-blue-600{% else %}text-gray-700{% endif %}">
                –í—Å–µ
            </a>

            {% for category in categories %}
                <a href="?category={{ category.name }}"
                   class="px-4 py-2 rounded-full text-sm border
                   {% if current_category == category.name %}bg-blue-600 text-white border-blue-600{% else %}text-gray-700{% endif %}">
                    {{ category.name }}
                </a>
            {% endfor %}
        </div>
    {% endif %}

    {% if exam_rules_url %}
    <div class="flex items-start gap-3 bg-red-50 rounded-xl p-4 border border-red-100 mb-10">

        <!-- Icon -->
        <svg class="w-5 h-5 text-red-600 shrink-0 mt-0.5"
            fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round"
            viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>

        <!-- Text -->
        <div class="text-sm text-red-900 leading-relaxed">

            <p class="font-semibold mb-1">
                –ü–µ—Ä–µ–¥ —Ç–µ—Å—Ç–æ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ —ç–∫–∑–∞–º–µ–Ω–∞
            </p>

            <p class="text-red-800">
                90% –æ—à–∏–±–æ–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∏–∑-–∑–∞ –Ω–µ–∑–Ω–∞–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ —ç–∫–∑–∞–º–µ–Ω–∞.
                –£–∑–Ω–∞–π—Ç–µ, –∫–∞–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç–µ—Å—Ç –∏ –∑–∞ —á—Ç–æ —Å–Ω–∏–º–∞—é—Ç –±–∞–ª–ª—ã ‚Äî
                <a href="{{ exam_rules_url }}" target="_blank"
                class="font-semibold underline underline-offset-2 hover:text-red-600 transition">
                –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ ‚Üí
                </a>
            </p>

        </div>

    </div>
    {% endif %}

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">

        {% for exam in exams %}
            <div class="bg-white rounded-2xl shadow hover:shadow-xl transition p-6 flex flex-col">

                <h3 class="text-xl font-semibold mb-2">
                    {{ exam.title }}
                </h3>

                {% if exam.description %}
                    <p class="text-gray-600 text-sm mb-4 flex-grow">
                        {{ exam.description|truncatechars:120 }}
                    </p>
                {% endif %}

                <div class="text-sm text-gray-500 mb-4">
                    üìù –¢–µ—Å—Ç–æ–≤: <span class="font-medium">{{ exam.tests_count }}</span>
                </div>

                <div class="text-sm text-gray-500 mb-4">
                {% if exam.last_attempt_id %}
                    {% widthratio exam.user_score exam.user_total 100 as percent %}

                    <div class="mt-3">
                        <p class="text-sm text-gray-600">
                            –ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
                            {{ exam.user_score }} / {{ exam.user_total }}
                            ({{ percent }}%)
                        </p>

                        <div class="w-full bg-gray-200 h-2 rounded mt-2">
                            <div class="bg-indigo-600 h-2 rounded"
                                style="width: {{ percent }}%"></div>
                        </div>
                    </div>
                {% else %}
                    <p class="text-gray-400 mt-3">
                        –≠–∫–∑–∞–º–µ–Ω –µ—â—ë –Ω–µ –Ω–∞—á–∞—Ç
                    </p>
                {% endif %}
                </div>

                <div class="mt-auto flex items-center justify-between">
                        <a href="{% url 'tests:exam_detail' exam.id %}"
                            class="inline-flex items-center text-sm text-white bg-blue-600 px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                                –ù–∞—á–∞—Ç—å
                            <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                        </a>
                </div>

            </div>
        {% empty %}
            <p>–≠–∫–∑–∞–º–µ–Ω–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</p>
        {% endfor %}

    </div>

</section>

{% endblock %}
